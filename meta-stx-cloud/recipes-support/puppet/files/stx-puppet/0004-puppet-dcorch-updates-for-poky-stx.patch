From dea274faeadd858924bc1124dec9b574975560ef Mon Sep 17 00:00:00 2001
From: Jackie Huang <jackie.huang@windriver.com>
Date: Thu, 27 May 2021 15:26:01 +0800
Subject: [PATCH 04/12] puppet-dcorch-updates-for-poky-stx

Upstream-Status: Inappropriate [poky-stx specific]

Rebased for stx 5.0

Signed-off-by: Jackie Huang <jackie.huang@windriver.com>
---
 .../puppet-dcorch/src/dcorch/manifests/params.pp   | 34 ++++++++++++++++------
 1 file changed, 25 insertions(+), 9 deletions(-)

diff --git a/modules/puppet-dcorch/src/dcorch/manifests/params.pp b/modules/puppet-dcorch/src/dcorch/manifests/params.pp
index df823dc..c4b727a 100644
--- a/modules/puppet-dcorch/src/dcorch/manifests/params.pp
+++ b/modules/puppet-dcorch/src/dcorch/manifests/params.pp
@@ -14,16 +14,32 @@ class dcorch::params {
   $dcorch_paste_api_ini = '/etc/dcorch/api-paste.ini'
 
   if $::osfamily == 'Debian' {
-    $package_name          = 'distributedcloud-dcorch'
-    $client_package        = 'distributedcloud-client-dcorchclient'
-    $api_package           = 'distributedcloud-dcorch'
-    $api_service           = 'dcorch-api'
-    $engine_package        = 'distributedcloud-dcorch'
-    $engine_service        = 'dcorch-engine'
-    $api_proxy_package      = 'distributedcloud-dcorch'
-    $api_proxy_service      = 'dcorch-api-proxy'
+    if $::operatingsystem == 'poky-stx' {
 
-    $db_sync_command       = 'dcorch-manage db_sync'
+      $package_name          = 'dcorch'
+      $client_package        = 'distributedcloud-client-dcorchclient'
+      $api_package           = false
+      $api_service           = 'dcorch-api'
+      $engine_package        = false
+      $engine_service        = 'dcorch-engine'
+      $api_proxy_package      = false
+      $api_proxy_service      = 'dcorch-api-proxy'
+      $db_sync_command       = 'dcorch-manage db_sync'
+
+    } else {
+
+      $package_name          = 'distributedcloud-dcorch'
+      $client_package        = 'distributedcloud-client-dcorchclient'
+      $api_package           = 'distributedcloud-dcorch'
+      $api_service           = 'dcorch-api'
+      $engine_package        = 'distributedcloud-dcorch'
+      $engine_service        = 'dcorch-engine'
+      $api_proxy_package      = 'distributedcloud-dcorch'
+      $api_proxy_service      = 'dcorch-api-proxy'
+
+      $db_sync_command       = 'dcorch-manage db_sync'
+
+    }
 
   } elsif($::osfamily == 'RedHat') {
 
-- 
2.7.4

